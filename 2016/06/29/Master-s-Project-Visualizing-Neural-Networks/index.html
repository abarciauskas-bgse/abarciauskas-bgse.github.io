<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><script type="text/javascript" src="http://d3js.org/d3.v3.js" charset="utf-8"></script><script type="text/javascript" src="/javascripts/d3.tip.js"></script><script type="text/javascript" src="/javascripts/columnChart.js"></script><script type="text/javascript" src="http://numericjs.com/numeric/lib/numeric-1.2.6.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/jstat/1.5.2/jstat.min.js"></script><script type="text/javascript" src="https://protobi.com/examples/pca/pca.js"></script><title> Recurrent Neural Networks: Visualization and Music Generation (Master's Project) · Aimee Barciauskas</title><meta name="description" content="Recurrent Neural Networks: Visualization and Music Generation (Master's Project) - Aimee Barciauskas"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600"></head><body><header><a href="/" class="logo-link"><img></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/abarciauskas-bgse" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Recurrent Neural Networks: Visualization and Music Generation (Master's Project)</h1><div class="post-time">Jun 29, 2016</div><div class="post-content"><p><em>This post is an extraction of the <a href="/masters_project/masters_project.pdf">my master’s project paper</a>, and is mirrored closely by these <a href="https://docs.google.com/presentation/d/1VSFKc4-oQLmgLZp9yahKdYhM_eYlRtgZpxfwcimRYpY/pub?start=false&amp;loop=false&amp;delayms=3000" target="_blank" rel="external">presentation slides</a></em></p>
<p>The final product is <a href="https://calm-spire-21695.herokuapp.com/" target="_blank" rel="external">here</a>.</p>
<p>For my master’s project, I worked with the <a href="https://www.bsc.es/viz/" target="_blank" rel="external">Scientific Visualization Group</a> at Barcelona Supercomputing Center on <strong><a href="https://www.bsc.es/viz/algorritmo/" target="_blank" rel="external">Algorritmo</a></strong>. <strong><a href="https://www.bsc.es/viz/algorritmo/" target="_blank" rel="external">Algorritmo</a></strong> was an experiment into how neural networks (NNs), and specifically recurrent neural networks, can generate music and was a part of the <a href="http://sonarplusd.com/es/" target="_blank" rel="external">Sonar+D Creativity and Technology Conference</a>, June 16-18, 2016.</p>
<p>The components of this project were:</p>
<ol>
<li>Developing a deeper understanding of NNs via:<ol>
<li>Computational graphs</li>
<li>Code for single neurons</li>
<li>Generating music with an LSTM-based Network</li>
</ol>
</li>
<li>Literature review</li>
<li>Research existing tools for NN visualization</li>
<li>Iterative design and final product</li>
</ol>
<h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><p>Since this is meant to be the TL;DR version of my paper, the rest of this post gives the punchline for each component.</p>
<h2 id="1-Deeper-understanding-of-NNs"><a href="#1-Deeper-understanding-of-NNs" class="headerlink" title="1. Deeper understanding of NNs"></a>1. Deeper understanding of NNs</h2><h3 id="1-1-Computational-Graphs"><a href="#1-1-Computational-Graphs" class="headerlink" title="1.1. Computational Graphs"></a>1.1. Computational Graphs</h3><p>I found computational graphs an incredibly useful way of understanding how one builds and trains a neural network. Below is a computational graph of a 2 layer RNN. In the future, it might be a fun project to digital version and / or generative tools for computational graphs.</p>
<p><img src="/masters_project/comp_graph_2lyrrnn.jpeg" alt="comp_graph_2lyrrnn"></p>
<h3 id="1-2-Code-for-single-neurons"><a href="#1-2-Code-for-single-neurons" class="headerlink" title="1.2.Code for single neurons"></a>1.2.Code for single neurons</h3><p><a href="https://github.com/abarciauskas-bgse/masters_project/blob/master/python_scripts/simple_sigmoid_classifier.py" target="_blank" rel="external">Sigmoid Classifier</a></p>
<p><a href="https://github.com/abarciauskas-bgse/masters_project/blob/master/python_scripts/simple_rnn_beerstackoverflow.ipynb" target="_blank" rel="external">Recurrent neuron</a>, trained on beer.stackoverflow.com text data</p>
<p><a href="https://github.com/abarciauskas-bgse/masters_project/blob/master/lstm/my_simple_lstm.py.ipynb" target="_blank" rel="external">LSTM Neuron</a></p>
<h3 id="1-3-Generating-Music-with-an-LSTM-Network"><a href="#1-3-Generating-Music-with-an-LSTM-Network" class="headerlink" title="1.3. Generating Music with an LSTM Network"></a>1.3. Generating Music with an LSTM Network</h3><p>As a proof of concept, I used Keras and an AWS GPU-backed AMI to produce music using the set of chords from a training set of midi files.</p>
<p><a href="https://github.com/abarciauskas-bgse/masters_project/blob/master/python_scripts/models1.ipynb" target="_blank" rel="external">Source code</a></p>
<p><a href="/masters_project/example.mid">example.mid</a></p>
<h2 id="2-Literature-review"><a href="#2-Literature-review" class="headerlink" title="2. Literature review"></a>2. Literature review</h2><p>The most fascinating thing I came across in the literature was <a href="https://www.cs.nyu.edu/~fergus/papers/zeilerECCV2014.pdf" target="_blank" rel="external">Visualizing and Understanding Convolutional Networks, Zeiler and Fergus</a>. They developed deconvnets which invert a trained neural network to enable visualization of what the trained network has learned at different layers. Analysis of the deconvnet visualization enabled them to make modifications to the original popular AlexNet which improved single-model results 1.7%.</p>
<p>Also, I would be remiss not to mention a few posts I refer to again and again:</p>
<ul>
<li><a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" target="_blank" rel="external">Understanding LSTMs, Christopher Olah</a></li>
<li><a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/" target="_blank" rel="external">The Unreasonable Effectiveness of Recurrent Neural Networks, Andrej Karpathy</a></li>
<li><a href="https://apaszke.github.io/lstm-explained.html" target="_blank" rel="external">LSTM implementation explained</a></li>
</ul>
<h2 id="3-Research-on-existing-tools-for-NN-visualization"><a href="#3-Research-on-existing-tools-for-NN-visualization" class="headerlink" title="3. Research on existing tools for NN visualization"></a>3. Research on existing tools for NN visualization</h2><p><a href="http://playground.tensorflow.org/" target="_blank" rel="external">Neural Network</a></p>
<p>When you see this and you play with it, you think “Game over”. Don’t reinvent the wheel. Can’t be done better than that.</p>
<p>And I agree with all of those sentiments wholeheartedly.</p>
<p>But, there is still:</p>
<ul>
<li>Visualzation of backpropagation</li>
<li>Visualization of a single neuron</li>
<li>Visualization of a recurrent neural network</li>
</ul>
<h3 id="4-Design-process-and-final-visualization"><a href="#4-Design-process-and-final-visualization" class="headerlink" title="4. Design process and final visualization"></a>4. Design process and final visualization</h3><p>The design process involved <a href="http://abarciauskas-bgse.github.io/2016/04/24/Visualizing-Neurons-for-a-Neural-Network/">many sketches</a> (plus more in <a href="/masters_project/masters_project.pdf">the paper</a>) and 3 sessions of user testing.</p>
<p>The final product is hosted <a href="https://calm-spire-21695.herokuapp.com/" target="_blank" rel="external">here</a>, with screenshots below.</p>
<p><img src="/masters_project/screenshot_neuron.png" alt="Neuron"><br><img src="/masters_project/screenshot_rnn.png" alt="screenshot rnn final"></p>
<p>Thanks for stopping by and please feel free to contact me with any questions! barciaai at gmail dot com.</p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/06/15/Women-in-Technology-event-at-Palantir/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2016 <a href="abarciauskas-bgse.github.io">Aimee Barciauskas</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?a36e15d9e2adec9a21fcdd9f686b1ed2";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>